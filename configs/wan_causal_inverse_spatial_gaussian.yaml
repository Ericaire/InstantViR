model_name: wan
generator_name: causal_wan
# generator_ckpt: ./outputs/wan_causal_inverse_spatial_gaussian/2025-08-04-03-06-49.481869_seed6431312/checkpoint_model_000800/model.pt
generator_ckpt: "./outputs/wan_causal_inverse_spatial_gaussian/2025-08-19-09-07-53.869462_seed6039510/checkpoint_model_002500/model.pt"
generator_fsdp_wrap_strategy: size
real_score_fsdp_wrap_strategy: size
fake_score_fsdp_wrap_strategy: size
text_encoder_fsdp_wrap_strategy: size
generator_grad:
  model: true
real_score_grad:
  model: false
fake_score_grad:
  model: true
denoising_step_list:
- 1000
- 757
- 522
- 0
num_train_timestep: 1000
timestep_shift: 8.0
real_guidance_scale: 3.5
generator_task: causal_video
real_task_type: bidirectional_video
fake_task_type: bidirectional_video
denoising_loss_type: flow
mixed_precision: true
seed: 0
wandb_host: WANDB_HOST
wandb_key: WANDB_KEY
wandb_entity: tyin
wandb_project: causvid_inverse
wandb_name: wan_causal_inverse_spatial_gaussian
sharding_strategy: no_shard
lr: 5.0e-06
beta1: 0.9
beta2: 0.999
data_path: ./data/mixkit_latents_spatial_blur_k61_s3_lmdb
batch_size: 2
log_iters: 100
negative_prompt: 色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走
dfake_gen_update_ratio: 5
image_or_video_shape:
- 1
- 21
- 16
- 60
- 104
output_path: ./outputs/wan_causal_inverse_spatial_gaussian
distillation_loss: dmd
gradient_checkpointing: true
backward_simulation: false
num_frame_per_block: 3
warp_denoising_step: false
compile_model: false
inverse_problem_type: spatial_blur
blur_kernel_size: 61
blur_sigma: 3.0
noise_level: 0.0
measurement_consistency_weight: 0.2
gradient_clip_norm: 1.0
ema_decay: 0.999
use_predegraded_dataset: true

# ==== Optional GT Consistency (DAVI-style) ====
# 是否加入与“干净目标”的监督一致性（默认关闭）。
# 我们提供两种空间选择：latent（高效）或 pixel（更重）。
use_gt_consistency: true
gt_consistency_space: latent  # latent | pixel

# _100_unprompt

# The video depicts a man wearing a green suit and a bowtie, standing in a dimly lit bar or restaurant setting. Initially, he is holding a glass filled with a dark liquid, likely an alcoholic beverage, and is about to take a sip. As the video progresses, he drinks from the glass. He is taking a sip. Throughout this sequence, the man's posture and the surrounding environment, including shelves with various bottles and a television screen displaying visuals, remain largely unchanged. The warm, ambient lighting casts an orange-yellow tint over the scene, maintaining a consistent atmosphere.

# The video features an individual in an indoor setting with green-tinted lighting, exhibiting a moody ambiance. Initially, the person faces the camera. As the video progresses, the individual turns their head away from the camera, adopting a more pensive or contemplative demeanor. Throughout the sequence, the background remains consistent, featuring a framed picture on the wall and a window with decorative bars. The dim lighting casts shadows across the scene, maintaining the overall moody atmosphere.

# torchrun --nproc_per_node=2 -m causvid.train_distillation \   --config_path configs/wan_causal_inverse_spatial_gaussian.yaml \   --no_visualize 

# python minimal_inference/autoregressive_inverse_inference.py \   --config_path configs/wan_causal_inverse_spatial_gaussian.yaml \   --checkpoint_folder ./outputs/wan_causal_inverse_spatial_gaussian/xxxx/checkpoint_model_000800 \   --output_folder ./outputs/infer_spatial_blur_test \   --test_video_index 0 \   --data_path /fs-computility/ai4sData/weiminbai/suzhe/CausVid/data/mixkit_latents_spatial_blur_k61_s3_lmdb \   --use_predegraded_dataset 